{# @prop routePrefix Route prefix for the dashboard link (e.g. 'admin', 'company') #}
{# @prop mainLinks Array of {label, route, params, isGranted, icon} #}
{# @prop userName Optional — user display name for the bottom card #}
{# @prop userRole Optional — user role or company name #}
{# @prop userInitials Optional — avatar initials, defaults to first letter of userName #}
{%- props routePrefix, mainLinks, userName = null, userRole = null, userInitials = null -%}
<aside
    data-sidebar-target="panel"
    class="-translate-x-full fixed inset-y-0 left-0 z-50 w-64 transition-transform duration-300 ease-in-out lg:relative lg:inset-auto lg:z-auto lg:translate-x-0 flex flex-col bg-sidebar text-sidebar-foreground border-r border-sidebar-border shrink-0"
>
    {# Logo — h-16 matches MainHeader height #}
    <div class="h-16 flex items-center px-6 shrink-0">
        <a href="{{ path(routePrefix ~ '_dashboard') }}" aria-label="{{ siteTitle }}">
            <img src="{{ asset('assets/images/logo.svg') }}" alt="{{ siteTitle }}" class="h-10 dark:brightness-0 dark:invert"/>
        </a>
    </div>

    {# Navigation #}
    <nav class="flex-1 overflow-y-auto py-4 space-y-0.5 mt-2">
        {% for link in mainLinks %}
            {% if link.isGranted %}
                {%- set isActive = app.request.attributes.get('_route') == link.route -%}
                <div class="{{ isActive ? 'pr-4' : 'px-3' }}">
                    <a
                        class="flex items-center gap-3 py-2.5 text-sm font-medium transition-colors {{ isActive ? 'pl-6 rounded-r-full bg-sidebar-accent text-sidebar-accent-foreground' : 'px-3 rounded-lg text-sidebar-foreground/60 hover:text-primary' }}"
                        href="{{ path(link.route, link.params ?? []) }}"
                    >
                        <twig:ux:icon name="{{ link.icon }}" class="size-4 shrink-0 {{ isActive ? '' : '' }}"/>
                        <span>{{ link.label }}</span>
                    </a>
                </div>
            {% endif %}
        {% endfor %}
    </nav>

    {# Optional help block #}
    {% block help %}{% endblock %}

    {# User card #}
    {% if userName is not null %}
        <twig:SFUIToolbox:Layout:SidebarUser
            name="{{ userName }}"
            role="{{ userRole ?? '' }}"
            initials="{{ userInitials ?? '' }}"
            routePrefix="{{ routePrefix }}"
        />
    {% endif %}
</aside>
